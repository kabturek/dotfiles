<?php

/**
 * Absence
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ptclean
 * @subpackage model
 * @author     Marcin DomaÅ„ski <marcin+ptclean@kabturek.info>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Absence extends BaseAbsence
{
  public function postSave($event){
    $employee = Doctrine::getTable('Employee')->find($this->employee_id);
    $employee->updateAbsence();
    if($employee->highAbsency()){
      Alert::sendOffice($employee->id, 'Alert - high absency', 
        'New absency recorded. Day to end of the year: '.$employee->getToYearEnd() .'
        Time off remaining: '.$employee->gettimeOffRemaining().'
       Occurences remaining: '.$employee->getOccurencesRemaining()); 

    }
  }
}
